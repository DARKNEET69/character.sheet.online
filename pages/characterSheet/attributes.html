<!DOCTYPE html>
<html lang="en">
	<head>		
		<meta charset="utf-8" />
        <title>Character Sheet Online</title>
        <meta name="description" content="Create dynamic character sheet for any TRPG system" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
        <link rel="stylesheet" href="../../styles/main-style.css" />
        <meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff" />
		<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#222224" />
		<meta name="apple-mobile-web-app-capable" content="yes">

        <!-- Open Graph -->
        <meta property="og:type" content="website" />
        <meta property="og:title" content="Character Sheet Online" />
        <meta property="og:description" content="Create customizable character sheet for any TRPG system" />
        <meta property="og:site_name" content="character.sheet.online" />
        <meta property="og:url" content="https://darkneet69.github.io/character.sheet.online" />
        <meta property="og:image" content="https://darkneet69.github.io/character.sheet.online/user.png" />

        <link rel="preload" href="../../manifest.json" />
        <link rel="manifest" href="../../manifest.json" />
        <script async src="https://unpkg.com/pwacompat" crossOrigin="anonymous"></script>

        <!-- icons -->
        <link rel="apple-touch-icon" sizes="120x120" href="../../icons/apple-touch-icon_120.png" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../icons/apple-touch-icon_180.png" />
		<link rel="icon" type="image/png" sizes="32x32" href="../../icons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="../../icons/favicon-16x16.png">
		<link rel="shortcut icon" href="../../icons/favicon.ico">

		<script src="../../scripts/app.js"></script>
	</head>
	<body>
		<div class="menu-wrapper">
			<menu>
				<a class="bar-button" href="../../index.html">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><path d="M7 22H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3h2a1 1 0 0 0 0-2H5a5.006 5.006 0 0 0-5 5v14a5.006 5.006 0 0 0 5 5h2a1 1 0 0 0 0-2Z" fill="var(--major-text-color)" data-original="#000000"></path><path d="m23 11-15.777.032a2.018 2.018 0 0 1 .326-.446l3.879-3.879a1 1 0 1 0-1.414-1.414L6.133 9.172a4 4 0 0 0 0 5.656l3.879 3.879a1 1 0 1 0 1.414-1.414l-3.879-3.879a2.01 2.01 0 0 1-.291-.382L23 13a1 1 0 0 0 0-2Z" fill="var(--major-text-color)" data-original="#000000"></path></g></svg>
				</a>
				<div class="bar-title">
					<h1> BIO </h1>
				</div>
				<a class="bar-button" href="../settings/settings.html">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M1 4.75h2.736a3.728 3.728 0 0 0 7.195 0H23a1 1 0 0 0 0-2H10.931a3.728 3.728 0 0 0-7.195 0H1a1 1 0 0 0 0 2ZM7.333 2a1.75 1.75 0 1 1-1.75 1.75A1.752 1.752 0 0 1 7.333 2ZM23 11h-2.736a3.727 3.727 0 0 0-7.194 0H1a1 1 0 0 0 0 2h12.07a3.727 3.727 0 0 0 7.194 0H23a1 1 0 0 0 0-2Zm-6.333 2.75a1.75 1.75 0 1 1 1.75-1.75 1.752 1.752 0 0 1-1.75 1.75ZM23 19.25H10.931a3.728 3.728 0 0 0-7.195 0H1a1 1 0 0 0 0 2h2.736a3.728 3.728 0 0 0 7.195 0H23a1 1 0 0 0 0-2ZM7.333 22a1.75 1.75 0 1 1 1.75-1.75A1.753 1.753 0 0 1 7.333 22Z" fill="var(--major-text-color)" data-original="#000000"></path></g></svg>
				</a>
			</menu>
		</div>

		<div class="main-wrapper">
			<main propertyPath="attributes">
				<div type="button" class="roll-button" id="rollButton">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="m20.717 4.43-6.3-3.764a4.714 4.714 0 0 0-4.834 0l-6.3 3.764A4.704 4.704 0 0 0 1 8.446v7.109c0 1.636.875 3.174 2.283 4.016l6.3 3.764a4.721 4.721 0 0 0 4.834 0l6.3-3.764A4.704 4.704 0 0 0 23 15.555V8.446a4.704 4.704 0 0 0-2.283-4.016Zm-6.813-2.905 6.3 3.764c.498.297.911.706 1.215 1.183l-4.325 2.17-4.181-7.528c.343.087.678.224.991.412ZM12 1.529l4.153 7.47H7.85L12 1.53Zm-8.205 3.76 6.301-3.764a3.69 3.69 0 0 1 .992-.412l-4.18 7.529L2.582 6.47a3.677 3.677 0 0 1 1.214-1.181ZM2.019 15.927a3.556 3.556 0 0 1-.02-.373V8.445c0-.365.056-.724.161-1.067l4.232 2.125-4.372 6.424Zm4.948-5.495 4.115 6.996-8.437-.645 4.322-6.351Zm4.532 12.536a3.718 3.718 0 0 1-1.404-.493l-6.3-3.764a3.666 3.666 0 0 1-1.027-.915l8.732.662v4.51ZM7.874 10h8.251L12 17.014 7.875 10Zm12.33 8.711-6.3 3.764a3.702 3.702 0 0 1-1.404.494v-4.504l8.723-.657c-.277.357-.62.666-1.018.903Zm-7.292-1.276 4.123-7.009 4.432 6.36-8.555.649Zm9.087-1.88c0 .078-.003.157-.008.234l-4.383-6.286 4.231-2.123c.105.342.16.7.16 1.065v7.109Z" fill="var(--major-text-color)" data-original="#000000" class=""></path></g></svg>
				</div>
			</main>
		</div>

		<div class="nav-wrapper">
			<nav>
				<a class="bar-button" href="bio.html">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><path d="M12 12a6 6 0 1 0-6-6 6.006 6.006 0 0 0 6 6Zm0-10a4 4 0 1 1-4 4 4 4 0 0 1 4-4ZM12 14a9.01 9.01 0 0 0-9 9 1 1 0 0 0 2 0 7 7 0 0 1 14 0 1 1 0 0 0 2 0 9.01 9.01 0 0 0-9-9Z" fill="var(--major-text-color)" data-original="#000000"></path></g></svg>
				</a>
				<a class="bar-button" href="attributes.html">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><path d="M19 2h-1V1a1 1 0 0 0-2 0v1H8V1a1 1 0 0 0-2 0v1H5C2.243 2 0 4.243 0 7v12c0 2.757 2.243 5 5 5h4a1 1 0 0 0 0-2H5c-1.654 0-3-1.346-3-3v-9h21a1 1 0 0 0 1-1V7c0-2.757-2.243-5-5-5Zm3 6H2V7c0-1.654 1.346-3 3-3h14c1.654 0 3 1.346 3 3v1Zm-3.121 4.879-5.707 5.707A3.976 3.976 0 0 0 12 21.415v1.586a1 1 0 0 0 1 1h1.586a3.973 3.973 0 0 0 2.828-1.172l5.707-5.707c.567-.567.879-1.32.879-2.122s-.312-1.555-.878-2.121c-1.134-1.134-3.11-1.134-4.243 0Zm2.828 2.828-5.708 5.707a1.983 1.983 0 0 1-1.414.586h-.586v-.586c0-.534.208-1.036.586-1.414l5.708-5.707a1.023 1.023 0 0 1 1.414 0c.189.188.293.439.293.707s-.104.518-.293.707ZM5 14a1 1 0 0 1 1-1h7a1 1 0 0 1 0 2H6a1 1 0 0 1-1-1Zm6 4a1 1 0 0 1-1 1H6a1 1 0 0 1 0-2h4a1 1 0 0 1 1 1Z" fill="var(--major-text-color)" data-original="#000000"></path></g></svg>
				</a>
				<a class="bar-button" href="inventory.html">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><path d="M14.648 5.493c.872-.701 1.772-1.643 2.227-2.788a1.948 1.948 0 0 0-.203-1.816A2.017 2.017 0 0 0 15 0H9a2.02 2.02 0 0 0-1.672.889 1.948 1.948 0 0 0-.204 1.814c.456 1.146 1.355 2.089 2.228 2.789C4.695 7.221 1 13.159 1 18c0 3.309 2.691 6 6 6h10c3.309 0 6-2.691 6-6 0-4.841-3.695-10.779-8.352-12.507Zm.368-3.528c-.515 1.296-2.094 2.393-3.018 2.91-.923-.513-2.495-1.6-2.999-2.875l6.017-.035ZM16.999 22H7c-2.206 0-4-1.794-4-4 0-5.243 4.71-11 9-11s9 5.757 9 11c0 2.206-1.794 4-4 4Z" fill="var(--major-text-color)" data-original="#000000"></path></g></svg>
				</a>
				<a class="bar-button" href="actions.html">
					<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><path d="M19 24h-5a5.006 5.006 0 0 1-5-5v-5a5.006 5.006 0 0 1 5-5h5a5.006 5.006 0 0 1 5 5v5a5.006 5.006 0 0 1-5 5Zm-5-13a3 3 0 0 0-3 3v5a3 3 0 0 0 3 3h5a3 3 0 0 0 3-3v-5a3 3 0 0 0-3-3Zm0 2a1 1 0 1 0 1 1 1 1 0 0 0-1-1Zm5 5a1 1 0 1 0 1 1 1 1 0 0 0-1-1ZM9 7a1 1 0 1 0-1-1 1 1 0 0 0 1 1ZM7 9a1 1 0 1 0-1 1 1 1 0 0 0 1-1Zm-.22 6.826a1 1 0 0 0-.154-1.405 3.15 3.15 0 0 1-.251-.228l-3.511-3.559a3.005 3.005 0 0 1 .029-4.243l3.56-3.511a2.98 2.98 0 0 1 2.106-.864h.022a2.981 2.981 0 0 1 2.115.893L14.2 6.465c.057.058.111.117.163.179A1 1 0 1 0 15.9 5.356c-.083-.1-.17-.194-.266-.292L12.12 1.505a5 5 0 0 0-7.071-.049l-3.56 3.511a5.007 5.007 0 0 0-.049 7.071L4.951 15.6a4.865 4.865 0 0 0 .423.381 1 1 0 0 0 1.406-.153Z" fill="var(--major-text-color)" data-original="#000000"></path></g></svg>
				</a>
			</nav>
		</div>

		<dialog id="blockSettingsDialog">
			<form>
				<div style="display: flex; flex-direction: column; gap: 10px;">
					<div class="card-title" style="text-align: center;"> Block Settings </div>
					<div class="minor-button" id="dialogClose" style="position: absolute;top: 5px; right: 10px;" onclick="blockSettingsDialog.close();">âœ•</div>
					<input type="text" id="blockName" value="" required>
					<input type="text" id="blockTitle" value="">
					<select id="blockType" required>
						<option value="section" selected>Section</option>
						<option value="item">Item</option>
						<option value="label">Label</option>
						<option value="text">Text</option>
						<option value="number">Number</option>
						<option value="button">Button</option>
						<option value="calc">Calc</option>
					</select>
					<input type="submit" id="blockSave" value="Save" style="color: var(--blue-color);">
					<input type="submit" id="blockDelete" value="Delete" style="color: var(--red-color);">
				</div>
			</form>
		</dialog>

		<script>
			document.addEventListener("submit", (e) => saveBlockSettings(e));
			const selectedCharacterId = localStorage.getItem("selectedCharacterId");
			let currentCharacter;
			getIndexedDB(loadCharacter);
			function loadCharacter() {
				const transaction = db.transaction(["characterSheets"], "readonly");
				const objectStore = transaction.objectStore("characterSheets");
				const request = objectStore.getAll();				
				request.onerror = function(event) {
					console.error("Error getting character: " + event.target.errorCode);
				};
				request.onsuccess = function(event) {
					console.log("Character retrieved successfully");
					request.result.forEach((character) => {
						if (character.id == selectedCharacterId){
							currentCharacter = character;
							let mainContainer = document.querySelector("main");
							renderCharacterProperties(currentCharacter.attributes.value, mainContainer);
						}
					});
				};
			}
		</script>

		<script>
			if ("serviceWorker" in navigator) {
				window.addEventListener("load", function () {
					navigator.serviceWorker
						.register("../../serviceWorker.js")
						.then((registration) => {
							console.log("SW registration successful");
						});
				});
			}
		</script>
	</body>
</html>
